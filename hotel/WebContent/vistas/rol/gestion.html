          <form id="formulario"  method="post" action="../rol/guardar"
              	data-fv-framework="bootstrap"
              	data-fv-excluded="disabled"
    			data-fv-icon-valid="glyphicon glyphicon-ok"
    			data-fv-icon-invalid="glyphicon glyphicon-remove"
    			data-fv-icon-validating="glyphicon glyphicon-refresh">
            <div  id="modalAdicionar" class="modal fade">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Adicionar Rol</h4>
                  </div>
                  <div class="modal-body">
                  	<div class="form-group">
                      <label>Nombre</label>
                      <input type="text" class="form-control" id="nom_rol" name="nom_rol" 
                      data-fv-notempty="true">
                    </div>
                  </div>
                  <div class="modal-footer">
                  	<button type="button" class="btn btn-social btn-google" data-dismiss="modal"><i class="glyphicon glyphicon-remove-sign"></i> Cancelar</button>
                    <button type="button" id="btnAdicionarConfirmacion" class="btn btn-social btn-bitbucket"><i class="glyphicon glyphicon-floppy-disk"></i> Guardar</button>
                  </div>
                </div><!-- /.modal-content -->
              </div><!-- /.modal-dialog -->
            </div><!-- /.modal -->
          <div id="modalAdicionarConfirmacion" class="modal fade">
  			<div class="modal-dialog modal-sm"  role="document">
    			<div class="modal-content">
      			<div class="modal-header">
        		<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        			<h4 class="modal-title" id="myModalLabel"><span class="fa fa-chevron-circle-right"></span> Mensaje de Confirmacion</h4>
      			</div>
      			<div class="modal-body">
      				<label>¿Esta seguro de realizar esta transaccion?</label>
				</div>
      			<div class="modal-footer">
        			<button type="button" class="btn btn-social btn-google" data-dismiss="modal"><i class="glyphicon glyphicon-remove-sign"></i> Cancelar</button>
        			<button type="submit" class="btn btn-social btn-bitbucket"><i class="glyphicon glyphicon-ok-sign"></i> Aceptar</button>
      			</div>
    			</div>
  			</div>
			</div>
			</form>
			<form id="formularioModificar"  method="post" action="../rol/actualizar"
              	data-fv-framework="bootstrap"
              	data-fv-excluded="disabled"
    			data-fv-icon-valid="glyphicon glyphicon-ok"
    			data-fv-icon-invalid="glyphicon glyphicon-remove"
    			data-fv-icon-validating="glyphicon glyphicon-refresh">
			<div  id="modalModificar" class="modal fade">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Modificar Rol</h4>
                  </div>
                  <div class="modal-body">
                  <input type="hidden" id="cod_rol" name="cod_rol" />
                  	<div class="form-group">
                      <label>Nombre</label>
                      <input type="text" class="form-control" id="nom_rol" name="nom_rol" 
                      data-fv-notempty="true">
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-social btn-google" data-dismiss="modal"><i class="glyphicon glyphicon-remove-sign"></i> Cancelar</button>
                    <button type="button" id="btnModificarConfirmacion" class="btn btn-social btn-bitbucket"><i class="glyphicon glyphicon-floppy-disk"></i> Guardar</button>
                  </div>
                </div><!-- /.modal-content -->
              </div><!-- /.modal-dialog -->
            </div><!-- /.modal -->
            <div id="modalModificarConfirmacion" class="modal fade">
  			<div class="modal-dialog modal-sm"  role="document">
    			<div class="modal-content">
      			<div class="modal-header">
        		<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        			<h4 class="modal-title" id="myModalLabel"><span class="fa fa-chevron-circle-right"></span> Mensaje de Confirmacion</h4>
      			</div>
      			<div class="modal-body">
      				<label>¿Esta seguro de realizar esta transaccion?</label>
				</div>
      			<div class="modal-footer">
        			<button type="button" class="btn btn-social btn-google" data-dismiss="modal"><i class="glyphicon glyphicon-remove-sign"></i> Cancelar</button>
        			<button type="submit" class="btn btn-social btn-bitbucket"><i class="glyphicon glyphicon-ok-sign"></i> Aceptar</button>
      			</div>
    			</div>
  			</div>
			</div>
			 </form>
            <div  id="modalEliminar" class="modal fade">
              <div class="modal-dialog">
              <form id="formularioEliminar"  method="post" action="../rol/eliminar"
              	data-fv-framework="bootstrap"
              	data-fv-excluded="disabled"
    			data-fv-icon-valid="glyphicon glyphicon-ok"
    			data-fv-icon-invalid="glyphicon glyphicon-remove"
    			data-fv-icon-validating="glyphicon glyphicon-refresh">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Eliminar Rol</h4>
                  </div>
                  <div class="modal-body">
                  <input type="hidden" id="cod_rol" name="cod_rol" />
                  	<p>Esta seguro de eliminar a <label id="rolLabel"></label></p>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-social btn-google pull-left" data-dismiss="modal"><i class="glyphicon glyphicon-remove-sign"></i> Cancelar</button>
                    <button type="submit" class="btn btn-social btn-bitbucket"><i class="glyphicon glyphicon-ok-sign"></i> Eliminar</button>
                  </div>
                </div><!-- /.modal-content -->
                </form>
              </div><!-- /.modal-dialog -->
            </div><!-- /.modal -->
            
            <div  id="modalActivar" class="modal modal-success fade">
              <div class="modal-dialog">
              <form id="formularioActivar"  method="post" action="../rol/activar"
              	data-fv-framework="bootstrap"
              	data-fv-excluded="disabled"
    			data-fv-icon-valid="glyphicon glyphicon-ok"
    			data-fv-icon-invalid="glyphicon glyphicon-remove"
    			data-fv-icon-validating="glyphicon glyphicon-refresh">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Activar Rol</h4>
                  </div>
                  <div class="modal-body">
                  <input type="hidden" id="cod_rol" name="cod_rol" />
                  	<p>Esta seguro de activar a <label id="rolLabel2"></label></p>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-social btn-google pull-left" data-dismiss="modal"><i class="glyphicon glyphicon-remove-sign"></i> Cancelar</button>
                    <button type="submit" class="btn btn-social btn-bitbucket"><i class="glyphicon glyphicon-ok-sign"></i> Activar</button>
                  </div>
                </div><!-- /.modal-content -->
                </form>
              </div><!-- /.modal-dialog -->
            </div><!-- /.modal -->
            
            <div  id="modalAsignar" class="modal fade">
              <div class="modal-dialog" >
              <form id="formularioAsignar"  method="post" action="../rol/guardarAsignacion"
              	data-fv-framework="bootstrap"
              	data-fv-excluded="disabled"
    			data-fv-icon-valid="glyphicon glyphicon-ok"
    			data-fv-icon-invalid="glyphicon glyphicon-remove"
    			data-fv-icon-validating="glyphicon glyphicon-refresh">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Asignar Menus a Rol</h4>
                  </div>
                  <div class="modal-body">
                  <input type="hidden" id="cod_rol" name="cod_rol" />
                  	<p>Rol : <label id="rolLabel3"></label></p>

                    	<div class="form-group">
                      		<label for="menus">Menus </label>
                      		<select id="menus" multiple="multiple" name="menus" class="form-control input-md" data-placeholder="Selecccionar..."></select>
                    	</div>
                   
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-social btn-google pull-left" data-dismiss="modal"><i class="glyphicon glyphicon-remove-sign"></i> Cancelar</button>
                    <button type="submit" class="btn btn-social btn-bitbucket"><i class="glyphicon glyphicon-ok-sign"></i> Guardar</button>
                  </div>
                </div><!-- /.modal-content -->
                </form>
              </div><!-- /.modal-dialog -->
            </div><!-- /.modal -->
            
          <div class="box">
            <div class="box-header with-border">
            <b style="font-size: 24px;">Gestion Roles</b>
            <div class="btn-group pull-right">
			<label class="btn btn-primary active estadoRadio"> <input
				type="radio" name="estado" value="true"  data-toggle="tooltip" data-placement="top" title="Mostrar Activos" checked> Activos
			</label> <label class="btn btn-danger estadoRadio"  data-toggle="tooltip" data-placement="top" title="Mostrar Inactivos"> <input
				type="radio" name="estado" value="false"> Inactivos
			</label>
            </div>
  
            </div>
            <div class="box-body">

             <table id="tabla" class="table table-striped table-bordered bg-yellow" cellspacing="0" width="100%">
                    <thead>
                      <tr>
                        <th>Código</th>
                        <th>Nombre</th>
                        <th>Acciones 
                        <button class="btn btn-primary active pull-right" id="btnAdicionar"><span class="glyphicon glyphicon-ok-circle"></span> Adicionar <span class="fa fa-plus-circle"></span></button>
                        </th>
                      </tr>
                    </thead>
                    <tbody class="bg-yellow">

                    </tbody>
                  </table>
            </div><!-- /.box-body -->
          </div><!-- /.box -->
          <script>
      $(document).ready(function(){
    	  $('select').chosen({no_results_text : "No se encuentra:",width : '100%'});
    	  $('#btnAdicionarConfirmacion').click(function(){
    			$('#modalAdicionarConfirmacion').modal('show');
    		});
          	$('#btnModificarConfirmacion').click(function(){
          		$('#modalModificarConfirmacion').modal('show');
          	});
          	 $('#btnAdicionar').click(function(){
             	$('#formulario')[0].reset();
     			$('#formulario').data('formValidation').resetForm();
     			$('#modalAdicionar').modal('show');
             });
  		$('#tabla').dataTable( {
  			dom:"<'row'<'col-sm-3'f><'col-sm-2'B><'col-sm-2'l><'col-sm-5'i>><'row'<'col-sm-12'tr>><'row'<'col-sm-5'i><'col-sm-7'p>>",
			"ordering":false,
  			"oLanguage": {
                "sUrl": "../../js/Spanish.lang"
            },
  			"processing": true,
  		    "serverSide": true,
  		    "ajax": {
  		    	"type": "POST",
  	            "url": "../rol/lista",
  	        	"data": function ( d ) {
  	                d.estado = $('input[name=estado]:checked').val();
  	            }
          	},
  		    "columns": [
  		                { "data": "cod_rol" },
  		                { "data": "nom_rol" },
  		                { "data":"cod_rol"}
  		    ],
  		    "createdRow": function ( row, data, index ){
  				if($('input[name=estado]:checked').val()=='true'){
  					var btnUser='';
  					if(data.menus==0)btnUser='<button class="btn btn-info asignar" data-id="'+data.cod_rol+'"  data-toggle="tooltip" data-placement="top" title="Asignar Menus"><i class="glyphicon glyphicon-eye-open"></i> </button>';
  					else btnUser='<button class="btn btn-success asignar"  data-toggle="tooltip" data-placement="top" title="Reasignar Menus" data-id="'+data.cod_rol+'"><i class="glyphicon glyphicon-eye-close"></i> </button>';
  					$('td', row).eq(2).html('<div class="btn-group">'+btnUser+'<button class="btn btn-primary modificar"  data-toggle="tooltip" data-placement="top" title="Modificar" data-id="'+data.cod_rol+'"><i class="glyphicon glyphicon-edit"></i> </button><button class="btn btn-danger eliminar"  data-toggle="tooltip" data-placement="top" title="Eliminar" data-id="'+data.cod_rol+'"><i class="glyphicon glyphicon-remove"></i> </button></div>');
  					$('td',row).addClass('bg-gray');
  				}else
  				$('td', row).eq(2).html('<button class="btn btn-primary activar" data-id="'+data.cod_rol+'" data-toggle="tooltip" data-placement="top" title="Dar de alta"><i class="glyphicon glyphicon-plus-sign"></i>  </button>');				        
  	        },
  	        "drawCallback": function( settings ) {
          		$('.eliminar').click(function(){ 
          			$('#formularioEliminar')[0].reset();
              		$.post('../rol/obtener?cod_rol='+$(this).data('id'), function(result) {
  		            	if(result.status==true){
  			    	        $('#modalEliminar').modal('show');
  							$('#formularioEliminar').loadJSON(result.data);
  							$('#rolLabel').html(result.data.nom_rol);				
  		            	}else{
  		            		mostrarMensaje('error','No se realizo con exito la Transacción');
  		            	}
  			        }, 'json');
          		});
          		$('.activar').click(function(){ 
          			$('#formularioActivar')[0].reset();
              		$.post('../rol/obtener?cod_rol='+$(this).data('id'), function(result) {
  		            	if(result.status==true){
  		            		$('#modalActivar').modal('show');
  							$('#formularioActivar').loadJSON(result.data);
  							$('#rolLabel2').html(result.data.nom_rol);				
  		            	}else{
  		            		mostrarMensaje('error','No se realizo con exito la Transacción');
  		            	}
  			        }, 'json');
          		});
          		$('.asignar').click(function(){ 
          			$('#formularioAsignar').data('formValidation').resetForm();
          			$('#formularioAsignar')[0].reset();
              		$.post('../rol/obtener?cod_rol='+$(this).data('id'), function(result) {
  		            	if(result.status==true){
  		            		$('#modalAsignar').modal('show');
  							if(result.data!=null)$('#formularioAsignar').loadJSON(result.data);
  							$('#rolLabel3').html(result.data.nom_rol);
  							$('#menus').html('');
  							$.each(result.menus,function(i,item){
  								var row=$('<option value="'+item.cod_men+'" '+item.tipo+'>'+item.nom_men+'</option>');
  								$('#menus').append(row);
  							});
  							$('#menus').trigger('chosen:updated');
  		            	}else{
  		            		mostrarMensaje('error','No se realizo con exito la Transacción');
  		            	}
  			        }, 'json');
          		});
          		$('.modificar').click(function(){
          			$('#formularioModificar').data('formValidation').resetForm();
          			$('#formularioModificar')[0].reset();
              		$.post('../rol/obtener?cod_rol='+$(this).data('id'), function(result) {
  		            	if(result.status==true){
  		            		$('#formularioModificar').loadJSON(result.data);
  		            		$('#modalModificar').modal('show');
  		            	}else{
  		            		mostrarMensaje('error','No se realizo con exito la Transacción');
  		            	}
  			        }, 'json');
          		});
  				$('button[data-toggle="tooltip"]').tooltip({animated: 'fade',placement: 'bottom',});
  		
          	}
  		});
  		$('.estadoRadio').click(function(){
  			$('#tabla').dataTable().fnDraw('page');
  		});
  		$('#formulario,#formularioModificar,#formularioEliminar,#formularioActivar,#formularioAsignar').formValidation(
  				{locale: 'es_ES'}).on('success.form.fv', function(e) {
              e.preventDefault();
              var $form = $(e.target);
              $.post($form.attr('action'), $form.serialize(), function(result) {
              	if(result.status==true){
      	            $form.data('formValidation').resetForm();
   	    	 		$('.modal').modal('hide');
      	        	$('#tabla').dataTable().fnDraw('page');
      	        	mostrarMensaje('info','Se realizo con exito la Transacción');
      	        }else{
              		mostrarMensaje('error','No se realizo con exito la Transacción');
              	}
      	    }, 'json');
          });
  		$('#nom').blur(function(){
      	  $.post('../rol/validar?nom_rol='+$(this).val(),function(resp){
				if(resp.status==true){
					$('#nom').val('');
					mostrarMensaje('error','Este rol ya existe!!!');
				}
			});
		});
  	});
    </script>