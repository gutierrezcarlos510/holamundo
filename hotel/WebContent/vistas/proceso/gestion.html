<form id="formulario"  method="post" action="../proceso/guardar"
              	data-fv-framework="bootstrap"
              	data-fv-excluded="disabled"
    			data-fv-icon-valid="glyphicon glyphicon-ok"
    			data-fv-icon-invalid="glyphicon glyphicon-remove"
    			data-fv-icon-validating="glyphicon glyphicon-refresh">
            <div  id="modalAdicionar" class="modal fade">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title"><span class="fa fa-chevron-circle-right"></span> Adicionar Proceso</h4>
                  </div>
                  <div class="modal-body">
                  	<div class="form-group">
                      <label>Nombre</label>
                      <input type="text" class="form-control" id="nom_pro" name="nom_pro"
                      data-fv-notempty="true">
                    </div>
                    <div class="form-group">
                      <label>Url</label>
                      <input type="text" class="form-control" id="url_pro" name="url_pro" placeholder="../directorio/metodo"
                      data-fv-notempty="true">
                    </div>
                    <div class="form-group">
							<label>Icono: </label>
                        <input type="text" class="form-control" id="ico_pro" name="ico_pro" data-fv-notempty="true">
					</div>
                  </div>
                  <div class="modal-footer">
                  	<button type="button" class="btn btn-social btn-google" data-dismiss="modal"><i class="glyphicon glyphicon-remove-sign"></i> Cancelar</button>
                    <button type="button" id="btnAdicionarConfirmacion" class="btn btn-social btn-bitbucket"><i class="glyphicon glyphicon-floppy-disk"></i> Guardar</button>
                  </div>
                </div><!-- /.modal-content -->
              </div><!-- /.modal-dialog -->
            </div><!-- /.modal -->
          	<div id="modalAdicionarConfirmacion" class="modal modal-primary fade">
  			<div class="modal-dialog modal-sm"  role="document">
    			<div class="modal-content">
      			<div class="modal-header">
        		<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        			<h4 class="modal-title" id="myModalLabel"><span class="fa fa-chevron-circle-right"></span> Mensaje de Confirmacion</h4>
      			</div>
      			<div class="modal-body">
      				<label>¿Esta seguro de realizar esta transaccion?</label>
				</div>
      			<div class="modal-footer">
        			<button type="button" class="btn btn-social btn-google" data-dismiss="modal"><i class="glyphicon glyphicon-remove-sign"></i> Cancelar</button>
        			<button type="submit" class="btn btn-social btn-bitbucket"><i class="glyphicon glyphicon-ok-sign"></i> Aceptar</button>
      			</div>
    			</div>
  			</div>
			</div>
                </form>
            <form id="formularioModificar"  method="post" action="../proceso/actualizar"
              	data-fv-framework="bootstrap"
              	data-fv-excluded="disabled"
    			data-fv-icon-valid="glyphicon glyphicon-ok"
    			data-fv-icon-invalid="glyphicon glyphicon-remove"
    			data-fv-icon-validating="glyphicon glyphicon-refresh">
			<div  id="modalModificar" class="modal fade">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title"><span class="fa fa-chevron-circle-right"></span>  Modificar Proceso</h4>
                  </div>
                  <div class="modal-body">
                  <input type="hidden" id="cod_pro" name="cod_pro" />
                  	<div class="form-group">
                      <label>Nombre</label>
                      <input type="text" class="form-control" id="nom_pro" name="nom_pro"
                      data-fv-notempty="true">
                    </div>
                    <div class="form-group">
                      <label>Url</label>
                      <input type="text" class="form-control" id="url_pro" name="url_pro" placeholder="../directorio/metodo"
                      data-fv-notempty="true">
                    </div>
                     <div class="form-group">
							<label>Icono:</label>
                        <input type="text" class="form-control" id="ico_pro" name="ico_pro" data-fv-notempty="true">
					</div>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-social btn-google" data-dismiss="modal"><i class="glyphicon glyphicon-remove-sign"></i> Cancelar</button>
                    <button type="button" id="btnModificarConfirmacion" class="btn btn-social btn-bitbucket"><i class="glyphicon glyphicon-floppy-disk"></i> Guardar</button>
                  </div>
                </div><!-- /.modal-content -->
              </div><!-- /.modal-dialog -->
            </div><!-- /.modal -->
            <div id="modalModificarConfirmacion" class="modal fade">
  			<div class="modal-dialog modal-sm"  role="document">
    			<div class="modal-content">
      			<div class="modal-header">
        		<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        			<h4 class="modal-title" id="myModalLabel"><span class="fa fa-chevron-circle-right"></span> Mensaje de Confirmacion</h4>
      			</div>
      			<div class="modal-body">
      				<label>¿Esta seguro de realizar esta transaccion?</label>
				</div>
      			<div class="modal-footer">
        			<button type="button" class="btn btn-social btn-google" data-dismiss="modal"><i class="glyphicon glyphicon-remove-sign"></i> Cancelar</button>
        			<button type="submit" class="btn btn-social btn-bitbucket"><i class="glyphicon glyphicon-ok-sign"></i> Aceptar</button>
      			</div>
    			</div>
  			</div>
			</div>
            </form>
            <div  id="modalEliminar" class="modal fade">
              <div class="modal-dialog">
              <form id="formularioEliminar"  method="post" action="../proceso/eliminar"
              	data-fv-framework="bootstrap"
              	data-fv-excluded="disabled"
    			data-fv-icon-valid="glyphicon glyphicon-ok"
    			data-fv-icon-invalid="glyphicon glyphicon-remove"
    			data-fv-icon-validating="glyphicon glyphicon-refresh">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title"><span class="fa fa-chevron-circle-right"></span> Eliminar Proceso</h4>
                  </div>
                  <div class="modal-body">
                  <input type="hidden" id="cod_pro" name="cod_pro" />
                  	<p>Esta seguro de eliminar a <label id="procesoLabel"></label></p>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-social btn-google" data-dismiss="modal"><i class="glyphicon glyphicon-remove-sign"></i> Cancelar</button>
        			<button type="submit" class="btn btn-social btn-bitbucket"><i class="glyphicon glyphicon-ok-sign"></i> Eliminar</button>
                  </div>
                </div><!-- /.modal-content -->
                </form>
              </div><!-- /.modal-dialog -->
            </div><!-- /.modal -->
            <div  id="modalActivar" class="modal fade">
              <div class="modal-dialog">
              <form id="formularioActivar"  method="post" action="../proceso/activar"
              	data-fv-framework="bootstrap"
              	data-fv-excluded="disabled"
    			data-fv-icon-valid="glyphicon glyphicon-ok"
    			data-fv-icon-invalid="glyphicon glyphicon-remove"
    			data-fv-icon-validating="glyphicon glyphicon-refresh">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title"><span class="fa fa-chevron-circle-right"></span> Activar Proceso</h4>
                  </div>
                  <div class="modal-body">
                  <input type="hidden" id="cod_pro" name="cod_pro" />
                  	<p>Esta seguro de activar a <label id="procesoLabel2"></label></p>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-social btn-google" data-dismiss="modal"><i class="glyphicon glyphicon-remove-sign"></i> Cancelar</button>
        			<button type="submit" class="btn btn-social btn-bitbucket"><i class="glyphicon glyphicon-ok-sign"></i> Activar</button>
                  </div>
                </div><!-- /.modal-content -->
                </form>
              </div><!-- /.modal-dialog -->
            </div><!-- /.modal -->
          <div class="box">
            <div class="box-header with-border">
            <b style="font-size: 24px;">Gestion Procesos</b>
            <div class="btn-group pull-right">
			<label class="btn btn-primary active estadoRadio"> <input
				type="radio" name="estado" value="true"  data-toggle="tooltip" data-placement="top" title="Mostrar Activos" checked> Activos
			</label> <label class="btn btn-danger estadoRadio"  data-toggle="tooltip" data-placement="top" title="Mostrar Inactivos"> <input
				type="radio" name="estado" value="false"> Inactivos
			</label>
            </div>
            </div>
            <div class="box-body">
             <table id="tabla" class="table table-striped table-bordered bg-yellow" cellspacing="0" width="100%">
                    <thead>
                      <tr>
                        <th>Código</th>
                        <th>Icono</th>
                        <th>Nombre</th>
                        <th>Url</th>
                        <th>Acciones
                        <button class="btn btn-primary active pull-right" id="btnAdicionar"><span class="glyphicon glyphicon-ok-circle"></span> Adicionar <span class="fa fa-plus-circle"></span></button></th>
                      </tr>
                    </thead>
                    <tbody>

                    </tbody>
                  </table>
            </div><!-- /.box-body -->
          </div><!-- /.box -->
          <script>
      $(document).ready(function(){
    	$('select').chosen({no_results_text : "No se encuentra:",width : '100%'});
		$('#btnAdicionarConfirmacion').click(function(){
			$('#modalAdicionarConfirmacion').modal('show');
		});
      	$('#btnModificarConfirmacion').click(function(){
      		$('#modalModificarConfirmacion').modal('show');
      	});
      	$('#btnAdicionar').click(function(){
         	$('#formulario')[0].reset();
 			$('#formulario').data('formValidation').resetForm();
 			$('#modalAdicionar').modal('show');
         });
		$('#tabla').dataTable( {
			dom:"<'row'<'col-sm-3'f><'col-sm-2'B><'col-sm-2'l><'col-sm-5'i>><'row'<'col-sm-12'tr>><'row'<'col-sm-5'i><'col-sm-7'p>>",
			"ordering":false,
  			"oLanguage": {
                "sUrl": "../../js/Spanish.lang"
            },
  			"processing": true,
  		    "serverSide": true,
  		    "ajax": {
  		    	"type": "POST",
  	            "url": "../proceso/lista",
  	        	"data": function ( d ) {
  	                d.estado = $('input[name=estado]:checked').val();
  	            }
          	},
  		    "columns": [
  		                { "data": "cod_pro" },
  		              	{ "data": "cod_pro" },
  		                { "data": "nom_pro" },
  		              	{ "data": "url_pro" },
  		                { "data":"cod_pro"}
  		    ],
  		    "createdRow": function ( row, data, index ){
  		    	$('td',row).eq(1).html('<button class="btn btn-info"  data-toggle="tooltip" data-placement="top" title="Icono"><i class="'+data.ico_pro+'"></i></button>');
  				if($('input[name=estado]:checked').val()=='true')
  					$('td', row).eq(4).html('<div class="btn-group"><button type="submit" class="btn btn-social btn-bitbucket modificar" data-toggle="tooltip" data-placement="top" title="Modificar" data-id="'+data.cod_pro+'"><i class="glyphicon glyphicon-edit"></i> Modificar</button><button type="button" data-toggle="tooltip" data-placement="top" title="Eliminar" data-id="'+data.cod_pro+'" class="btn btn-social btn-google eliminar"><i class="glyphicon glyphicon-remove-sign"></i> Cancelar</button></div>');
  				else
  					$('td', row).eq(4).html('<button class="btn btn-primary activar" data-id="'+data.cod_pro+'" data-toggle="tooltip" data-placement="top" title="Dar de alta"><i class="glyphicon glyphicon-plus-sign"></i>  </button>');
  				$('td',row).addClass('bg-gray');
  	        },
  	        "drawCallback": function( settings ) {
          		$('.eliminar').click(function(){
          			$('#formularioEliminar')[0].reset();
              		$.post('../proceso/obtener?cod_pro='+$(this).data('id'), function(result) {
  		            	if(result.status==true){
  			    	        $('#modalEliminar').modal('show');
  							$('#formularioEliminar').loadJSON(result.data);
  							$('#procesoLabel').html('<button class="btn btn-info"  data-toggle="tooltip" data-placement="top" title="Icono"><i class="'+result.data.ico_pro+'"></i></button> '+result.data.nom_pro);				
  		            	}else{
  		            		mostrarMensaje('error','No se realizo con exito la Transacción');
  		            	}
  			        }, 'json');
          		});
          		
          		$('.activar').click(function(){ 
          			$('#formularioActivar')[0].reset();
              		$.post('../proceso/obtener?cod_pro='+$(this).data('id'), function(result) {
  		            	if(result.status==true){
  		            		$('#modalActivar').modal('show');
  							$('#formularioActivar').loadJSON(result.data);
  							$('#procesoLabel2').html(result.data.nom_pro);				
  		            	}else{
  		            		mostrarMensaje('error','No se realizo con exito la Transacción');
  		            	}
  			        }, 'json');
          		});
          		
          		$('.modificar').click(function(){
          			$('#formularioModificar').data('formValidation').resetForm();
          			$('#formularioModificar')[0].reset();
              		$.post('../proceso/obtener?cod_pro='+$(this).data('id'), function(result) {
  		            	if(result.status==true){
  		            		$('#formularioModificar').loadJSON(result.data);
  		            		$('#modalModificar').modal('show');
  		            	}else{
  		            		mostrarMensaje('error','No se realizo con exito la Transacción');
  		            	}
  			        }, 'json');
          		});
  				$('button[data-toggle="tooltip"]').tooltip({animated: 'fade',placement: 'bottom',});
  		
          	}
  		});
  		$('.estadoRadio').click(function(){
  			$('#tabla').dataTable().fnDraw('page');
  		});
  		$('#formulario,#formularioModificar,#formularioEliminar,#formularioActivar').formValidation(
  				{locale: 'es_ES'}).on('success.form.fv', function(e) {
              e.preventDefault();
              var $form = $(e.target);
              $.post($form.attr('action'), $form.serialize(), function(result) {
              	if(result.status==true){
      	            $form.data('formValidation').resetForm();
   	    	 		$('.modal').modal('hide');
      	        	$('#tabla').dataTable().fnDraw('page');
      	        	mostrarMensaje('info','Se realizo con exito la Transacción');
      	        }else{
              		mostrarMensaje('error','No se realizo con exito la Transacción');
              	}
      	    }, 'json');
          });
  		$('#nom').blur(function(){
      	  $.post('../proceso/validar?nom_pro='+$(this).val(),function(resp){
				if(resp.status==true){
					$('#nom_pro').val('');
					mostrarMensaje('error','Este proceso ya existe!!!');
				}
			});
		});
  	});
    </script>