<script src="../../js/fileinput.min.js"></script>
            <form id="formulario"  method="post" action="../general/guardar" enctype="multipart/form-data"
              	data-fv-framework="bootstrap"
              	data-fv-excluded="disabled"
    			data-fv-icon-valid="glyphicon glyphicon-ok"
    			data-fv-icon-invalid="glyphicon glyphicon-remove"
    			data-fv-icon-validating="glyphicon glyphicon-refresh">
            <div  id="modalAdicionar" class="modal fade">
              <div class="modal-dialog sm" style="width: 70%">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Adicionar General</h4>
                  </div>
                  <div class="modal-body">
                  	<div class="row">
                  		<div class="col-md-2">
                  			<div class="form-group">
                      			<label>Gestion</label>
                      			<input type="text" id="ges_gen" name="ges_gen" class="form-control" data-fv-notempty="true" data-fv-integer="true">
                    		</div>
                  		</div>
                  		<div class="col-md-3">
                  			<div class="form-group">
                      			<label>Nombre empresa o sigla</label>
                      		<input type="text" id="nom_gen" name="nom_gen" class="form-control" data-fv-notempty="true">
                    		</div>
                  		</div>
                  		<div class="col-md-7">
                  			<div class="form-group">
                      			<label>Descripcion empresa</label>
                      			<input type="text" id="des_gen" name="des_gen" class="form-control" data-fv-notempty="true">
                    		</div>
                  		</div>
                  	</div>
                  	<div class="row">
                  		<div class="col-md-4">
                  			<div class="form-group">
                      			<label>Logo empresa</label>
                      			<input type="file" id="logtex_gen1" name="logtex_gen1" class="form-control file" data-fv-notempty="true">
                    		</div>
                  		</div>
                  		<div class="col-md-4">
                  			<div class="form-group">
                      			<label>Logo Sin texto</label>
                      			<input type="file" id="logsintex_gen1" name="logsintex_gen1" class="form-control file" data-fv-notempty="true">
                    		</div>		
                  		</div>
                  		<div class="col-md-4">
                  			<div class="form-group">
                      			<label>Telefono</label>
                      			<input type="text" id="tel_gen" name="tel_gen" class="form-control" data-fv-notempty="true" data-fv-integer="true">
                    		</div>
                  		</div>
                  	</div>
                  	<div class="row">
                  		
                  		<div class="col-md-8">
                  			<div class="form-group">
                      		<label>Direccion</label>
                      		<input type="text" id="dir_gen" name="dir_gen" class="form-control" data-fv-notempty="true">
                    		</div>
                  		</div>
                  		<div class="col-md-4">
                  			<div class="form-group">
                     		<label>Lugar</label>
                      		<input type="text" id="lug_gen" name="lug_gen" class="form-control" data-fv-notempty="true">
                    		</div>
                  		</div>
                  	</div>
                    <div class="row">
                    	<div class="col-md-4">
                    		<div class="form-group">
                      		<label>Nit</label>
                      		<input type="text" id="nit_gen" name="nit_gen" class="form-control" data-fv-notempty="true">
                    		</div>
                    	</div>
                    </div>
                  </div>
                  <div class="modal-footer">
                  	<button type="button" class="btn btn-social btn-google" data-dismiss="modal"><i class="glyphicon glyphicon-remove-sign"></i> Cancelar</button>
                    <button type="button" id="btnAdicionarConfirmacion" class="btn btn-social btn-bitbucket"><i class="glyphicon glyphicon-floppy-disk"></i> Guardar</button>
                  </div>
                </div><!-- /.modal-content -->
              </div><!-- /.modal-dialog -->
            </div><!-- /.modal -->
          	<div id="modalAdicionarConfirmacion" class="modal fade">
  			<div class="modal-dialog modal-sm"  role="document">
    			<div class="modal-content">
      			<div class="modal-header">
        		<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        			<h4 class="modal-title" id="myModalLabel"><span class="fa fa-chevron-circle-right"></span> Mensaje de Confirmacion</h4>
      			</div>
      			<div class="modal-body">
      				<label>¿Esta seguro de realizar esta transaccion?</label>
				</div>
      			<div class="modal-footer">
        			<button type="button" class="btn btn-social btn-google" data-dismiss="modal"><i class="glyphicon glyphicon-remove-sign"></i> Cancelar</button>
        			<button type="submit" class="btn btn-social btn-bitbucket"><i class="glyphicon glyphicon-ok-sign"></i> Aceptar</button>
      			</div>
    			</div>
  			</div>
			</div>
          </form>
          <form id="formularioModificar"  method="post" action="../general/actualizar" enctype="multipart/file"
              	data-fv-framework="bootstrap"
              	data-fv-excluded="disabled"
    			data-fv-icon-valid="glyphicon glyphicon-ok"
    			data-fv-icon-invalid="glyphicon glyphicon-remove"
    			data-fv-icon-validating="glyphicon glyphicon-refresh">
            <div  id="modalModificar" class="modal fade">
              <div class="modal-dialog sm" style="width: 70%">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Modificar General</h4>
                  </div>
                  <div class="modal-body">
                  	<div class="row">
                  		<div class="col-md-2">
                  			<div class="form-group">
                      			<label>Gestion</label>
                      			<input type="text" id="ges_gen" name="ges_gen" class="form-control" data-fv-notempty="true" data-fv-integer="true">
                    		</div>
                  		</div>
                  		<div class="col-md-3">
                  			<div class="form-group">
                      			<label>Nombre empresa o sigla</label>
                      		<input type="text" id="nom_gen" name="nom_gen" class="form-control" data-fv-notempty="true">
                    		</div>
                  		</div>
                  		<div class="col-md-7">
                  			<div class="form-group">
                      			<label>Descripcion empresa</label>
                      			<input type="text" id="des_gen" name="des_gen" class="form-control" data-fv-notempty="true">
                    		</div>
                  		</div>
                  	</div>
                  	<div class="row">
                  		<div class="col-md-2 center">
                    	<img id="imagen1" class="img-thumbnail" width="125px">
                    	</div>
                  		<div class="col-md-4">
                  			<div class="form-group">
                      			<label>Logo</label>
                      			<input type="file" id="logtex_gen" name="logtex_gen1" class="form-control file">
                    		</div>
                  		</div>
                  		<div class="col-md-2 center">
                    	<img id="imagen2" class="img-thumbnail" width="125px">
                    	</div>
                  		<div class="col-md-4">
                  			<div class="form-group">
                      			<label>Logo sin texto</label>
                      			<input type="file" id="logsintex_gen" name="logsintex_gen1" class="form-control file">
                    		</div>		
                  		</div>
                  	</div>
                  	<div class="row">
                  		<div class="col-md-4">
                  			<div class="form-group">
                      			<label>Telefono</label>
                      			<input type="text" id="tel_gen" name="tel_gen" class="form-control" data-fv-notempty="true" data-fv-integer="true">
                    		</div>
                  		</div>
                  		<div class="col-md-8">
                  			<div class="form-group">
                      		<label>Direccion</label>
                      		<input type="text" id="dir_gen" name="dir_gen" class="form-control" data-fv-notempty="true">
                    		</div>
                  		</div>
                  	</div>
                    <div class="row">
                    	<div class="col-md-4">
                  			<div class="form-group">
                     		<label>Lugar</label>
                      		<input type="text" id="lug_gen" name="lug_gen" class="form-control" data-fv-notempty="true">
                    		</div>
                  		</div>
                    	<div class="col-md-4">
                    		<div class="form-group">
                      		<label>Nit</label>
                      		<input type="text" id="nit_gen" name="nit_gen" class="form-control" data-fv-notempty="true">
                    		</div>
                    	</div>
                    </div>
                  </div>
                  <div class="modal-footer">
                  	<button type="button" class="btn btn-social btn-google" data-dismiss="modal"><i class="glyphicon glyphicon-remove-sign"></i> Cancelar</button>
                    <button type="button" id="btnModificarConfirmacion" class="btn btn-social btn-bitbucket"><i class="glyphicon glyphicon-floppy-disk"></i> Guardar</button>
                  </div>
                </div><!-- /.modal-content -->
              </div><!-- /.modal-dialog -->
            </div><!-- /.modal -->
          	<div id="modalModificarConfirmacion" class="modal fade">
  			<div class="modal-dialog modal-sm"  role="document">
    			<div class="modal-content">
      			<div class="modal-header">
        		<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        			<h4 class="modal-title" id="myModalLabel"><span class="fa fa-chevron-circle-right"></span> Mensaje de Confirmacion</h4>
      			</div>
      			<div class="modal-body">
      				<label>¿Esta seguro de realizar esta transaccion?</label>
				</div>
      			<div class="modal-footer">
        			<button type="button" class="btn btn-social btn-google" data-dismiss="modal"><i class="glyphicon glyphicon-remove-sign"></i> Cancelar</button>
        			<button type="submit" class="btn btn-social btn-bitbucket"><i class="glyphicon glyphicon-ok-sign"></i> Aceptar</button>
      			</div>
    			</div>
  			</div>
			</div>
          </form>
            <div  id="modalEliminar" class="modal fade">
              <div class="modal-dialog">
              <form id="formularioEliminar"  method="post" action="../general/eliminar"
              	data-fv-framework="bootstrap"
              	data-fv-excluded="disabled"
    			data-fv-icon-valid="glyphicon glyphicon-ok"
    			data-fv-icon-invalid="glyphicon glyphicon-remove"
    			data-fv-icon-validating="glyphicon glyphicon-refresh">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Eliminar General</h4>
                  </div>
                  <div class="modal-body">
                  <input type="hidden" id="ges_gen1" name="ges_gen" />
                  	<p>Desea eliminar a <label id="ges_genLabel1"></label></p>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-social btn-google" data-dismiss="modal"><i class="glyphicon glyphicon-remove-sign"></i> Cancelar</button>
        			<button type="submit" class="btn btn-social btn-bitbucket"><i class="glyphicon glyphicon-ok-sign"></i> Eliminar</button>
                  </div>
                </div><!-- /.modal-content -->
                </form>
              </div><!-- /.modal-dialog -->
            </div><!-- /.modal -->
            
            <div  id="modalActivar" class="modal fade">
              <div class="modal-dialog">
              <form id="formularioActivar"  method="post" action="../general/activar"
              	data-fv-framework="bootstrap"
              	data-fv-excluded="disabled"
    			data-fv-icon-valid="glyphicon glyphicon-ok"
    			data-fv-icon-invalid="glyphicon glyphicon-remove"
    			data-fv-icon-validating="glyphicon glyphicon-refresh">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Activar General</h4>
                  </div>
                  <div class="modal-body">
                  <input type="hidden" id="ges_gen2" name="ges_gen" />
                  	<p>Esta seguro de activar a <label id="gestionLabel2"></label></p>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-social btn-google" data-dismiss="modal"><i class="glyphicon glyphicon-remove-sign"></i> Cancelar</button>
        			<button type="submit" class="btn btn-social btn-bitbucket"><i class="glyphicon glyphicon-ok-sign"></i> Activar</button>
                  </div>
                </div><!-- /.modal-content -->
                </form>
              </div><!-- /.modal-dialog -->
            </div><!-- /.modal -->
            
          <div class="box">
            <div class="box-header with-border">
            <b style="font-size: 24px;">Gestion Procesos</b>
            <div class="btn-group pull-right">
			<label class="btn btn-primary active estadoRadio"> <input
				type="radio" name="estado" value="true"  data-toggle="tooltip" data-placement="top" title="Mostrar Activos" checked> Activos
			</label> <label class="btn btn-danger estadoRadio"  data-toggle="tooltip" data-placement="top" title="Mostrar Inactivos"> <input
				type="radio" name="estado" value="false"> Inactivos
			</label>
            </div>
            </div>
            <div class="box-body">
             <table id="tabla" class="table table-striped table-bordered bg-yellow" cellspacing="0" width="100%">
                    <thead>
                      <tr>
                        <th>Gestion</th>
                        <th>Empresa</th>
                        <th>Descripción</th>
                        <th>Telefono</th>
                        <th>Direccion</th>
                        <th>Acciones
                        <button class="btn btn-primary active pull-right" id="btnAdicionar"><span class="glyphicon glyphicon-ok-circle"></span> Adicionar <span class="fa fa-plus-circle"></span></button>
                        </th>
                      </tr>
                    </thead>
                    <tbody>

                    </tbody>
                  </table>
            </div><!-- /.box-body -->
          </div><!-- /.box -->
          <script>
      $(document).ready(function(){
    	  $('select').chosen({no_results_text : "No se encuentra:",width : '100%'});
    	  $('#btnAdicionarConfirmacion').click(function(){
    			$('#modalAdicionarConfirmacion').modal('show');
    		});
          	$('#btnModificarConfirmacion').click(function(){
          		$('#modalModificarConfirmacion').modal('show');
          	});
          	$('#btnAdicionar').click(function(){
             	$('#formulario')[0].reset();
     			$('#formulario').data('formValidation').resetForm();
     			$('#modalAdicionar').modal('show');
             });
  		$('#tabla').dataTable( {
  			dom:"<'row'<'col-sm-3'f><'col-sm-2'B><'col-sm-2'l><'col-sm-5'i>><'row'<'col-sm-12'tr>><'row'<'col-sm-5'i><'col-sm-7'p>>",
			"ordering":false,
  			"oLanguage": {
                "sUrl": "../../js/Spanish.lang"
            },
  			"processing": true,
  		    "serverSide": true,
  		    "ajax": {
  		    	"type": "POST",
  	            "url": "../general/lista",
  	        	"data": function ( d ) {
  	                d.estado = $('input[name=estado]:checked').val();
  	            }
          	},
  		    "columns": [
  		                { "data": "ges_gen" },
  		              	{ "data": "nom_gen" },
  		                { "data": "des_gen" },
  		              	{ "data": "tel_gen" },
  		            	{ "data": "dir_gen" },
  		                { "data":"ges_gen"}
  		    ],
  		    "createdRow": function ( row, data, index ){
  				if($('input[name=estado]:checked').val()=='true'){
  					$('td', row).eq(5).html('<div class="btn-group"><button class="btn btn-primary modificar"  data-toggle="tooltip" data-placement="top" title="Modificar" data-id="'+data.ges_gen+'"><i class="glyphicon glyphicon-edit"></i> </button><button class="btn btn-danger eliminar"  data-toggle="tooltip" data-placement="top" title="Eliminar" data-id="'+data.ges_gen+'"><i class="glyphicon glyphicon-remove"></i> </button></div>');
  				}else
  				$('td', row).eq(5).html('<button class="btn btn-primary activar" data-id="'+data.ges_gen+'" data-toggle="tooltip" data-placement="top" title="Dar de alta"><i class="glyphicon glyphicon-plus-sign"></i>  </button>');				        
  				$('td',row).addClass('bg-gray');
  		    },
  	        "drawCallback": function( settings ) {
  	        	$('.modificar').click(function(){
          			$('#formularioModificar').data('formValidation').resetForm();
          			$('#formularioModificar')[0].reset();
          			$('#logtex_gen').fileinput('clear');
          			$('#logsintex_gen').fileinput('clear');
              		$.post('../general/obtener?ges_gen='+$(this).data('id'), function(result) {
  		            	if(result.status==true){
  		            		$('#formularioModificar').loadJSON(result.data);
  		            		$('#imagen1').attr('src','../../general/'+result.data.logtex_gen);
  		            		$('#imagen2').attr('src','../../general/'+result.data.logsintex_gen);
  		            		$('#modalModificar').modal('show');
  		            	}else{
  		            		mostrarMensaje('error','No se realizo con exito la Transacción');
  		            	}
  			        }, 'json');
          		});
          		$('.eliminar').click(function(){ 
          			$('#formularioEliminar')[0].reset();
              		$.post('../general/obtener?ges_gen='+$(this).data('id'), function(result) {
  		            	if(result.status==true){
  			    	        $('#modalEliminar').modal('show');
  							$('#formularioEliminar').loadJSON(result.data);
  							$('#ges_genLabel1').html('Gestion '+result.data.ges_gen);				
  		            	}else{
  		            		mostrarmensaje('error','No se realizo con exito la Transacción');
  		            	}
  			        }, 'json');
          		});
          		$('.activar').click(function(){ 
          			$('#formularioActivar')[0].reset();
              		$.post('../general/obtener?ges_gen='+$(this).data('id'), function(result) {
  		            	if(result.status==true){
  		            		$('#modalActivar').modal('show');
  							$('#formularioActivar').loadJSON(result.data);
  							$('#gestionLabel2').html('Gestion '+result.data.ges_gen);				
  		            	}else{
  		            		mostrarMensaje('error','No se realizo con exito la Transacción');
  		            	}
  			        }, 'json');
          		});
  				$('button[data-toggle="tooltip"]').tooltip({animated: 'fade',placement: 'bottom',});
          	}
  		});
  		$('.estadoRadio').click(function(){
  			$('#tabla').dataTable().fnDraw('page');
  		});
  		$('#formularioEliminar,#formularioActivar').formValidation(
  				{locale: 'es_ES'}).on('success.form.fv', function(e) {
              e.preventDefault();
              var $form = $(e.target);
              $.post($form.attr('action'), $form.serialize(), function(result) {
              	if(result.status==true){
      	            $form.data('formValidation').resetForm();
   	    	 		$('.modal').modal('hide');
      	        	$('#tabla').dataTable().fnDraw('page');
      	        	mostrarMensaje('info','Se realizo con exito la Transacción');
      	        }else{
              		mostrarmensaje('error','No se realizo con exito la Transacción');
              	}
      	    }, 'json');
          });
  		$('#formulario').formValidation({excluded: [':disabled']}).on('success.form.fv', function(e) {
  			e.preventDefault();
  		    $('.bubblingG').show();
  		    var $form = $(e.target);
  		    var formData=new FormData(document.getElementById("formulario"));
  		    $.ajax({
  		        url: $form.attr("action"),
  		        type: "post",
  		        dataType: "json",
  		        data: formData,
  		        cache: false,
  		        contentType: false,
  		        processData: false
  		    	}).done(function(result){
  			    	if(result.status==true){
  			    		$form.data('formValidation').resetForm();
  	   	    	 		$('.modal').modal('hide');
  	      	        	$('#tabla').dataTable().fnDraw('page');
  	      	        	mostrarMensaje('info','Se realizo con exito la Transacción');
  			    	}else{
  			    		mostrarMensaje('error','No se realizo con exito la Transacción');
  			    	}
  			    	$('.bubblingG').hide(); 
  		    });
  		});
  		$('#formularioModificar').formValidation({excluded: [':disabled']}).on('success.form.fv', function(e) {
  			e.preventDefault();
  		    $('.bubblingG').show();
  		    var $form = $(e.target);
  		    var formData=new FormData(document.getElementById("formularioModificar"));
  		    $.ajax({
  		        url: $form.attr("action"),
  		        type: "post",
  		        dataType: "json",
  		        data: formData,
  		        cache: false,
  		        contentType: false,
  		        processData: false
  		    	}).done(function(result){
  			    	if(result.status==true){
  			    		$form.data('formValidation').resetForm();
  	   	    	 		$('.modal').modal('hide');
  	      	        	$('#tabla').dataTable().fnDraw('page');
  	      	        	mostrarMensaje('info','Se realizo con exito la Transacción');
  			    	}else{
  			    		mostrarMensaje('error','No se realizo con exito la Transacción');
  			    	}
  			    	$('.bubblingG').hide(); 
  		    });
  		});
  		$('#gestion').blur(function(){
      	  $.post('../general/validar?gestion='+$(this).val()	,function(resp){
				if(resp.status){
					$('#gestion').val('');
					mostrarMensaje('error','Esta gestion ya existe!!!');
				}
			});
		});
  	});
    </script>